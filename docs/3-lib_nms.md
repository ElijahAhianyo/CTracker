# Lib Nms

[_Documentation generated by Documatic_](https://www.documatic.com)

<!---Documatic-section-Codebase Structure-start--->
## Codebase Structure

<!---Documatic-block-system_architecture-start--->
```mermaid
None
```
<!---Documatic-block-system_architecture-end--->

# #
<!---Documatic-section-Codebase Structure-end--->

<!---Documatic-section-lib.nms.cython_soft_nms_wrapper-start--->
## [lib.nms.cython_soft_nms_wrapper](3-lib_nms.md#lib.nms.cython_soft_nms_wrapper)

<!---Documatic-section-cython_soft_nms_wrapper-start--->
<!---Documatic-block-lib.nms.cython_soft_nms_wrapper-start--->
<details>
	<summary><code>lib.nms.cython_soft_nms_wrapper</code> code snippet</summary>

```python
def cython_soft_nms_wrapper(thresh, sigma=0.5, score_thresh=0.001, method='linear'):
    methods = {'hard': 0, 'linear': 1, 'gaussian': 2}
    assert method in methods, 'Unknown soft_nms method: {}'.format(method)

    def _nms(dets):
        (dets, _) = soft_nms(np.ascontiguousarray(dets, dtype=np.float32), np.float32(sigma), np.float32(thresh), np.float32(score_thresh), np.uint8(methods[method]))
        return dets
    return _nms
```
</details>
<!---Documatic-block-lib.nms.cython_soft_nms_wrapper-end--->
<!---Documatic-section-cython_soft_nms_wrapper-end--->

# #
<!---Documatic-section-lib.nms.cython_soft_nms_wrapper-end--->

<!---Documatic-section-lib.nms.py_nms_wrapper-start--->
## [lib.nms.py_nms_wrapper](3-lib_nms.md#lib.nms.py_nms_wrapper)

<!---Documatic-section-py_nms_wrapper-start--->
<!---Documatic-block-lib.nms.py_nms_wrapper-start--->
<details>
	<summary><code>lib.nms.py_nms_wrapper</code> code snippet</summary>

```python
def py_nms_wrapper(thresh):

    def _nms(dets):
        return nms(dets, thresh)
    return _nms
```
</details>
<!---Documatic-block-lib.nms.py_nms_wrapper-end--->
<!---Documatic-section-py_nms_wrapper-end--->

# #
<!---Documatic-section-lib.nms.py_nms_wrapper-end--->

<!---Documatic-section-lib.nms.cpu_nms_wrapper-start--->
## [lib.nms.cpu_nms_wrapper](3-lib_nms.md#lib.nms.cpu_nms_wrapper)

<!---Documatic-section-cpu_nms_wrapper-start--->
<!---Documatic-block-lib.nms.cpu_nms_wrapper-start--->
<details>
	<summary><code>lib.nms.cpu_nms_wrapper</code> code snippet</summary>

```python
def cpu_nms_wrapper(thresh):

    def _nms(dets):
        return greedy_nms(dets, thresh)[0]
    return _nms
```
</details>
<!---Documatic-block-lib.nms.cpu_nms_wrapper-end--->
<!---Documatic-section-cpu_nms_wrapper-end--->

# #
<!---Documatic-section-lib.nms.cpu_nms_wrapper-end--->

<!---Documatic-section-lib.nms.wnms_wrapper-start--->
## [lib.nms.wnms_wrapper](3-lib_nms.md#lib.nms.wnms_wrapper)

<!---Documatic-section-wnms_wrapper-start--->
```mermaid
flowchart LR
lib.nms.wnms_wrapper-->lib.nms_weighted_nms
```

### Object Calls

* lib.nms_weighted_nms

<!---Documatic-block-lib.nms.wnms_wrapper-start--->
<details>
	<summary><code>lib.nms.wnms_wrapper</code> code snippet</summary>

```python
def wnms_wrapper(thresh_lo, thresh_hi):

    def _nms(dets):
        return py_weighted_nms(dets, thresh_lo, thresh_hi)
    return _nms
```
</details>
<!---Documatic-block-lib.nms.wnms_wrapper-end--->
<!---Documatic-section-wnms_wrapper-end--->

# #
<!---Documatic-section-lib.nms.wnms_wrapper-end--->

<!---Documatic-section-lib.nms.nms-start--->
## [lib.nms.nms](3-lib_nms.md#lib.nms.nms)

<!---Documatic-section-nms-start--->
<!---Documatic-block-lib.nms.nms-start--->
<details>
	<summary><code>lib.nms.nms</code> code snippet</summary>

```python
def nms(dets, thresh):
    x1 = dets[:, 0]
    y1 = dets[:, 1]
    x2 = dets[:, 2]
    y2 = dets[:, 3]
    scores = dets[:, 4]
    areas = (x2 - x1 + 1) * (y2 - y1 + 1)
    order = scores.argsort()[::-1]
    keep = []
    while order.size > 0:
        i = order[0]
        keep.append(i)
        xx1 = np.maximum(x1[i], x1[order[1:]])
        yy1 = np.maximum(y1[i], y1[order[1:]])
        xx2 = np.minimum(x2[i], x2[order[1:]])
        yy2 = np.minimum(y2[i], y2[order[1:]])
        w = np.maximum(0.0, xx2 - xx1 + 1)
        h = np.maximum(0.0, yy2 - yy1 + 1)
        inter = w * h
        ovr = inter / (areas[i] + areas[order[1:]] - inter)
        inds = np.where(ovr <= thresh)[0]
        order = order[inds + 1]
    return dets[keep, :]
```
</details>
<!---Documatic-block-lib.nms.nms-end--->
<!---Documatic-section-nms-end--->

# #
<!---Documatic-section-lib.nms.nms-end--->

<!---Documatic-section-lib.nms.py_weighted_nms-start--->
## [lib.nms.py_weighted_nms](3-lib_nms.md#lib.nms.py_weighted_nms)

<!---Documatic-section-py_weighted_nms-start--->
<!---Documatic-block-lib.nms.py_weighted_nms-start--->
<details>
	<summary><code>lib.nms.py_weighted_nms</code> code snippet</summary>

```python
def py_weighted_nms(dets, thresh_lo, thresh_hi):
    x1 = dets[:, 0]
    y1 = dets[:, 1]
    x2 = dets[:, 2]
    y2 = dets[:, 3]
    scores = dets[:, 4]
    areas = (x2 - x1 + 1) * (y2 - y1 + 1)
    order = scores.argsort()[::-1]
    keep = []
    while order.size > 0:
        i = order[0]
        xx1 = np.maximum(x1[i], x1[order])
        yy1 = np.maximum(y1[i], y1[order])
        xx2 = np.minimum(x2[i], x2[order])
        yy2 = np.minimum(y2[i], y2[order])
        w = np.maximum(0.0, xx2 - xx1 + 1)
        h = np.maximum(0.0, yy2 - yy1 + 1)
        inter = w * h
        ovr = inter / (areas[i] + areas[order] - inter)
        inds = np.where(ovr <= thresh_lo)[0]
        inds_keep = np.where(ovr > thresh_hi)[0]
        if len(inds_keep) == 0:
            break
        order_keep = order[inds_keep]
        tmp = np.sum(scores[order_keep])
        x1_avg = np.sum(scores[order_keep] * x1[order_keep]) / tmp
        y1_avg = np.sum(scores[order_keep] * y1[order_keep]) / tmp
        x2_avg = np.sum(scores[order_keep] * x2[order_keep]) / tmp
        y2_avg = np.sum(scores[order_keep] * y2[order_keep]) / tmp
        keep.append([x1_avg, y1_avg, x2_avg, y2_avg, scores[i]])
        order = order[inds]
    return np.array(keep)
```
</details>
<!---Documatic-block-lib.nms.py_weighted_nms-end--->
<!---Documatic-section-py_weighted_nms-end--->

# #
<!---Documatic-section-lib.nms.py_weighted_nms-end--->

[_Documentation generated by Documatic_](https://www.documatic.com)